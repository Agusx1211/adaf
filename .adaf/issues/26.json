{
  "id": 26,
  "title": "CLI simplification pass: merge/remove ~6 redundant subcommands",
  "description": "Several CLI subcommands are redundant or duplicate functionality that already exists elsewhere. Removing them reduces surface area, LOC, and potential bugs with no loss of meaningful capability.\n\nThis is not just removing CLI commands — each one has tentacles into the store layer, prompt builder, protocol, TUI, and runtime. The full scope per command:\n\n## 1. decision (207 CLI LOC) → merge into doc\n\nFiles touched:\n- DELETE internal/cli/decision.go (207 LOC)\n- internal/store/store.go — remove ListDecisions(), CreateDecision(), GetDecision() (~45 LOC), remove \"decisions\" from storeDirs\n- internal/store/types.go — remove Decision struct (~10 LOC)\n- internal/store/store_test.go — remove decision tests\n- internal/cli/status.go — remove decisions section from runStatusFull() (~15 LOC)\n- internal/cli/init.go — remove \"decisions\" dir reference\n- pkg/protocol/protocol.go — remove `adaf decision create/list` references from the agent instruction protocol (~8 lines)\n- internal/config/role_catalog.go — references to decisions in role descriptions\n- .adaf/decisions/ directory — no longer created\n\nWhat stays: Turn.KeyDecisions field is unrelated (free-text field on turn records, not the Decision entity).\n\n## 2. note (114 CLI LOC) → delete (wide blast radius)\n\nFiles touched:\n- DELETE internal/cli/note.go (114 LOC)\n- internal/store/store.go — remove ListNotes(), CreateNote(), NotesByTurn() (~50 LOC), remove \"notes\" from storeDirs\n- internal/store/types_orchestration.go — remove SupervisorNote struct (~8 LOC)\n- internal/store/store_test.go — remove note tests\n- internal/prompt/builder.go — remove SupervisorNotes injection (~8 LOC) + remove field from BuildOptions\n- internal/loop/loop.go — remove note fetching and passing to prompt builder\n- internal/loop/loop_test.go — remove note-related test setup\n- internal/looprun/runner.go — remove note fetching\n- internal/orchestrator/orchestrator.go — remove note fetching/passing\n- internal/runtui/model.go — remove knownNotes map and initialization\n- internal/runtui/detail_layers.go — remove trackNoteActivity(), Notes stat field, note display (~30 LOC)\n- .adaf/notes/ directory — no longer created\n\nThis one is deep. Notes are threaded through loop -> orchestrator -> prompt builder -> runtui. Removing them simplifies all four.\n\n## 3. worktree (93 CLI LOC) → merge into cleanup\n\nFiles touched:\n- DELETE internal/cli/worktree.go (93 LOC)\n- internal/cli/cleanup.go — add a --list flag or list subcommand\n\nStraightforward. Just folding two commands that call the same worktree.Manager methods.\n\n## 4. doctor (344 CLI LOC) → merge into stats --format md\n\nFiles touched:\n- DELETE internal/cli/doctor.go (344 LOC)\n- internal/cli/stats_cmd.go — add --format markdown flag\n- internal/cli/runtime_view.go — remove doctor reference\n\nStraightforward. doctor is stats with markdown output.\n\n## 5. lookup (127 CLI LOC) → remove, covered by turn show\n\nFiles touched:\n- DELETE internal/cli/lookup.go (127 LOC)\n\nturn show already does hex ID lookup. Loop-run hex searching is niche and could go into turn search --hex.\n\n## 6. repair (60 CLI LOC) → merge into init\n\nFiles touched:\n- DELETE internal/cli/repair.go (60 LOC)\n- internal/cli/init.go — call s.Repair() when project already exists\n\nStraightforward.\n\n## Total estimated savings\n\n- ~945 LOC of CLI commands deleted\n- ~150-200 LOC of store methods/types deleted\n- ~50-80 LOC of prompt builder / protocol cleanup\n- ~30-50 LOC of runtui cleanup\n- ~20-30 LOC scattered across loop, looprun, orchestrator\n- 2 store directories eliminated (decisions/, notes/)\n- 6 fewer entries in adaf --help\n\nTotal: ~1.2-1.5k LOC removed across ~20 files. Less code, less bugs, smaller help output, fewer concepts to learn.",
  "status": "open",
  "priority": "medium",
  "labels": [
    "simplification",
    "tech-debt",
    "cli"
  ],
  "created": "2026-02-14T04:10:41.22358763Z",
  "updated": "2026-02-14T04:10:41.22358763Z"
}